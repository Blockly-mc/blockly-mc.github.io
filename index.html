<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Blockly-MC → JS</title>
<style>
:root {
  --bg: #0a0f2e;
  --fg: #ffffff;
  --panel: #1c2a5a;
  --border: #3a4a90;
  --btn-bg: #3a4a90;
  --btn-hover: #2a3870;
}
html, body { height: 100%; margin: 0; font-family: "Segoe UI", sans-serif; background: var(--bg); color: var(--fg);}
.app { display: grid; grid-template-rows: 50px 1fr; height: 100%; }
header { display:flex; align-items:center; padding:0 12px; border-bottom:1px solid var(--border); background: var(--panel);}
header h1 { font-size:18px; margin:0; flex:1; font-weight:bold;}
header button { margin-left:8px; padding:6px 12px; border-radius:12px; border:none; background: var(--btn-bg); color: var(--fg); cursor:pointer; transition:0.2s; font-weight:bold;}
header button:hover { background: var(--btn-hover); }
main { display:grid; grid-template-columns:1fr 40%; gap:8px; padding:8px; }
#blocklyArea { position:relative; border:2px solid var(--border); border-radius:12px; overflow:hidden; background:var(--panel);}
#blocklyDiv { position:absolute; inset:0;}
#codeOut { width:100%; height:100%; border:2px solid var(--border); border-radius:12px; background:var(--panel); color:var(--fg); padding:8px; font-family:monospace; font-size:13px; resize:none; box-sizing:border-box; }
</style>
<script src="https://unpkg.com/blockly/blockly.min.js"></script>
</head>
<body>
<div class="app">
  <header>
    <h1>Blockly-MC</h1>
    <button id="toggleTheme">Toggle Theme</button>
    <button id="copy">Copy</button>
  </header>
  <main>
    <div id="blocklyArea"><div id="blocklyDiv"></div></div>
    <textarea id="codeOut" placeholder="Generated JS code will appear here…"></textarea>
  </main>
</div>

<script>
// --- Toolbox, blocks, and generators remain same as your original code ---
// (copy your full blocks & Blockly.JavaScript generators here)

const workspace = Blockly.inject('blocklyDiv', { 
  toolbox, 
  theme: Blockly.Themes.Dark,
  grid: { spacing: 20, length: 3, colour: '#ffffff22', snap: true },
  trashcan: true
});

// --- Auto-generate code live ---
function generate() {
  const code = Blockly.JavaScript.workspaceToCode(workspace);
  const header = `import { world, system, ItemStack } from "@minecraft/server";\n\n`;
  document.getElementById('codeOut').value = header + code;
}

// Listen for any change in workspace
workspace.addChangeListener(generate);

// --- Copy to clipboard ---
async function copyCode(){
  const ta = document.getElementById('codeOut');
  if (!ta.value.trim()) return;
  try { await navigator.clipboard.writeText(ta.value); alert("Copied to clipboard!"); } 
  catch { ta.select(); document.execCommand('copy'); alert("Copied to clipboard!"); }
}
document.getElementById('copy').addEventListener('click', copyCode);

// --- Theme toggle ---
document.getElementById('toggleTheme').onclick = () => {
  if(document.body.dataset.theme === 'dark') delete document.body.dataset.theme;
  else document.body.dataset.theme = 'dark';
};
</script>
</body>
</html>
